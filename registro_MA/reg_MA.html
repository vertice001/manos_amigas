<!DOCTYPE html>

<html>

<head>
    <title>Crear Cuenta</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="regMA_estilos.css">
    <link rel="icon" href="file:///D:/POYP/logo_focus.jfif" type="image/x-icon">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/css/select2.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="regMA_datos.js"></script>
    <script src="regMA_funcion.js"></script>
</head>

<body class="p-3 m-0 border-0 bd-example">
    <form action="http://localhost/MA/reg_data_MA.php" id="formulario" method="POST">
        <div id="contenido">
            <h1>Ingresa Tu Informacion Personal</h1>
            <h3>Foto de Perfil</h3>
            <div class="photo_user">
                <div id="contenedorPerfil" onmouseover="mostrarIconoMas()" onmouseout="ocultarIconoMas()">
                    <img id="imagenPerfil" src="../default.png" alt="Foto de perfil">
                    <label id="photo_button" for="photo_profile">
                        <span id="iconoMas" style="display: none;"><i class="fas fa-camera"></i></span>
                        <script>
                            function handleInputChange(event) {
                                const fileInput = event.target;
                                const file = fileInput.files[0];

                                if (file) {
                                    const reader = new FileReader();

                                    reader.onload = function (e) {
                                        const imagenPerfil = document.getElementById('imagenPerfil');
                                        imagenPerfil.src = e.target.result;
                                    };

                                    reader.readAsDataURL(file);
                                }
                            }

                            function mostrarIconoMas() {
                                const iconoMas = document.getElementById('iconoMas');
                                iconoMas.style.display = 'block';
                            }

                            function ocultarIconoMas() {
                                const iconoMas = document.getElementById('iconoMas');
                                iconoMas.style.display = 'none';
                            }
                        </script>
                    </label>
                </div>
                <input id="photo_profile" name="photo_profile" type="file" accept="image/*"
                    onchange="handleInputChange(event)">
            </div>

            <div class="menu"></div>

            <div class="circle"></div>
            <img class="logo_locate" src="../logo_MA.jfif">

            <p class="tittle_profile">PERFIL DE USUARIO</p>

            <hr>

            <div class="form-floating mb-3 regis_nom">
                <input type="text" class="form-control" onkeypress="soloLetras(event)" onchange="toggleButton()"
                    id="reg_nom" name="reg_nom" placeholder="Nombre">
                <label for="floatingInput">Nombre</label>
            </div>

            <!-- <div class="form-floating mb-3 regis_edad">
                <input type="number" class="form-control" min="0" onchange="toggleButton()" id="reg_age" name="reg_age" placeholder="Edad">
                <label>Edad</label>
            </div> -->

            <div class="form-floating mb-3 regis_ape_pa">
                <input type="text" class="form-control" onkeypress="soloLetras(event)" onchange="toggleButton()"
                    id="reg_ape_pa" name="reg_ape_pa" placeholder="Apellido Paterno">
                <label>Apellido Paterno</label>
            </div>

            <div class="form-floating mb-3 regis_fnac">
                <input type="date" class="form-control" onchange="toggleButton()" id="reg_fnac" name="reg_fnac"
                    placeholder="Fecha de Nacimiento">
                <label>Fecha de Nacimiento</label>
            </div>

            <div class="form-floating mb-3 regis_ape_ma">
                <input type="text" class="form-control" onkeypress="soloLetras(event)" onchange="toggleButton()"
                    id="reg_ape_ma" name="reg_ape_ma" placeholder="Apellido Materno">
                <label>Apellido Materno</label>
            </div>

            <div class="form-floating mb-3 regis_rut">
                <div id="rut-error" style="color:red"></div>
                <input type="text" class="form-control" onkeyup="validarRut()" onchange="toggleButton()" id="reg_rut"
                    name="reg_rut" placeholder="Rut" maxlength="12">
                <label>Rut</label>
            </div>

            <div class="form-floating mb-3 regis_region">
                <select class="form-control" onchange="toggleButton()" id="reg_region" name="reg_region"
                    placeholder="Región">
                    <option value="1">Arica y Parinacota</option>
                    <option value="2">Tarapacá</option>
                    <option value="3">Antofagasta</option>
                </select>
                <label>Región</label>
            </div>

            <div class="form-floating mb-3 regis_ciudad">
                <select class="form-control" name="ciudades" onchange="toggleButton()" id="reg_ciudades"
                    name="reg_ciudades" placeholder="Ciudad">
                    <!-- Las opciones de ciudades se cargarán dinámicamente aquí -->
                </select>
                <label for="ciudades">Ciudad</label>
            </div>

            <script>
                // Lista de ciudades por Región
                const ciudadesPorRegion = {
                    1: [
                        { value: 1, label: "Arica" },
                        { value: 2, label: "Parinacota" },
                        { value: 3, label: "Putre" },
                        { value: 4, label: "Camarones" },
                        { value: 5, label: "General Lagos" },
                        { value: 6, label: "Chaca" },
                        { value: 7, label: "Guanacagua" },
                        { value: 8, label: "Socoroma" },
                        { value: 9, label: "Poconchile" },
                        { value: 10, label: "Cosapilla" },
                        { value: 11, label: "Codpa" },
                        { value: 12, label: "Visviri" },
                        { value: 13, label: "Chitita" },
                        { value: 14, label: "Belen" },
                        { value: 15, label: "Chucuyo" }
                    ],

                    2: [
                        { value: 16, label: "Iquique" },
                        { value: 17, label: "Pozo Almonte" },
                        { value: 18, label: "Alto Hospacio" },
                        { value: 19, label: "Camina" },
                        { value: 20, label: "Huara" },
                        { value: 21, label: "Pica" },
                        { value: 22, label: "Colchane" },
                        { value: 23, label: "Tarapacá" },
                        { value: 24, label: "Quebrada de Tarapacá" },
                        { value: 25, label: "La Tirana" }
                    ],
                    3: ["Ciudad de México", "Guadalajara", "Monterrey", "Puebla", "Tijuana",
                        "Ciudad Juárez", "León", "Zapopan", "Monterrey", "Nezahualcóyotl",
                        "Chihuahua", "Mérida", "San Luis Potosí", "Aguascalientes", "Saltillo",
                        "Mexicali", "Hermosillo", "Culiacán", "Guadalupe", "Querétaro",
                        "Morelia", "Toluca", "Nuevo Laredo", "Cancún", "Reynosa",
                        "Tuxtla Gutiérrez", "Durango", "Tlaquepaque", "Ciudad López Mateos", "Cuautitlán Izcalli",
                        "Fresnillo", "Orizaba", "Xalapa", "Mazatlán", "Coatzacoalcos",
                        "Los Mochis", "Ensenada"]
                };

                const regionesSelect = document.getElementById("reg_region");
                const ciudadesSelect = document.getElementById("reg_ciudades");

                // Función para cargar ciudades según el Región seleccionado
                function cargarCiudades() {
                    const regionSeleccionado = regionesSelect.value;
                    const ciudades = ciudadesPorRegion[regionSeleccionado] || [];

                    // Borra las opciones actuales
                    ciudadesSelect.innerHTML = "";

                    // Agrega las nuevas opciones de ciudades
                    ciudades.forEach(ciudad => {
                        const option = document.createElement("option");
                        option.value = ciudad.value;
                        option.textContent = ciudad.label; // Utiliza la propiedad "label"
                        ciudadesSelect.appendChild(option);
                    });

                }

                // Escucha el evento de cambio en el combo de Regiónes
                regionesSelect.addEventListener("change", cargarCiudades);

                // Carga las ciudades iniciales
                cargarCiudades();
            </script>

            <div class="form-floating mb-3 regis_direc ancho">
                <input type="text" class="form-control" onchange="toggleButton()" id="reg_direc" name="reg_direc"
                    placeholder="Dirección">
                <label>Dirección</label>
            </div>

            <div class="form-floating mb-3 regis_phone ancho">
                <input type="text" class="form-control" onchange="toggleButton()" id="reg_phone" name="reg_phone"
                    placeholder="Teléfono">
                <label>Teléfono</label>
            </div>

            <script>
                // Objeto que contiene los códigos de marcación internacional por Región
                const codigosMarcacion = {
                    argentina: "+54",
                    chile: "+56",
                    mexico: "+52"
                };

                // Obtén una referencia al combo box de Regiónes
                const regionSelect = document.getElementById("reg_region");

                // Obtén una referencia a la casilla de texto del código de marcación internacional
                const codigoMarcacionInput = document.getElementById("reg_phone");

                // Función para actualizar el código de marcación cuando se selecciona un Región
                function actualizarCodigoMarcacion() {
                    const regionSeleccionado = regionesSelect.value;
                    const codigoMarcacion = codigosMarcacion[regionSeleccionado] || "";

                    // Actualiza el valor de la casilla de texto
                    codigoMarcacionInput.value = codigoMarcacion;
                }

                // Escucha el evento de cambio en el combo de Regiónes
                regionesSelect.addEventListener("change", actualizarCodigoMarcacion);

                // Llama a la función para establecer el código de marcación inicial
                actualizarCodigoMarcacion();
            </script>

            <div class="form-floating mb-3 regis_mail ancho">
                <input type="email" class="form-control" onchange="toggleButton(); verificarCorreo();" id="reg_mail"
                    name="reg_mail" placeholder="Correo">
                <label>Correo</label>
            </div>
            <div id="error-mail" style="color: red;"></div>

            <div class="form-floating mb-3 regis_pass">
                <input type="password" class="form-control" onchange="toggleButton()" id="reg_pass" name="reg_pass"
                    placeholder="Contraseña">
                <label>Contraseña</label>
            </div>

            <div class="form-floating mb-3 regis_rep_pass">
                <input type="password" class="form-control" onchange="verificarContraseñas(); toggleButton();"
                    id="reg_rep_pass" name="reg_rep_pass" placeholder="Confirmar Contraseña">
                <label>Confirmar Contraseña</label>
            </div>
            <div id="error-pass" style="color: red;"></div>

            <div class="regis_button">
                <button type="button" class="btn btn-primary style_regis" id="reg_btn" name="reg_btn"
                    onclick="enviarDatos()" disabled>Registrarse</button>
            </div>

            <div class="cancel_regis">
                <a href="../index_MA/index.html"><button type="button" class="btn btn-secondary style_cancel"
                        id="cancel_reg" name="cancel_reg">Cancelar</button></a>
            </div>

            <div id="fondo_ord"></div>
        </div>
    </form>
</body>

</html>